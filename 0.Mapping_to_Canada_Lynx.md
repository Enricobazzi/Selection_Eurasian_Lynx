---
title: "Mapping_to_Canada_Lynx"
author: "Enrico"
date: "25 February 2020"
output: html_document
---

We decided to work with the new Canada Lynx genome (LyCa) as the reference. This means I will have to generate BAM files for all samples aligning the fastq reads to this reference. To speed up the process I will use the FT2 CESGA server. The process will be split into 2 steps:

## Step 1

A script (0.Mapping-executables/LL_CNAG_LyCa_mapping_launcher_cesga.sh) will sbatch a mapping to LyCa script for all elements in a folder which have a BARCODEID correspondent. BARCODEID is a "dictionary" made to have a correspondence between the sample name and the fastq name, as samples sequenced in CNAG have more than one fastq.

Note that I will use some conditions (if statements) in order to run only the samples I need:
```
if [ -f "$FILE" ]
```
to only process the files in the folder of interest, and
```
if [ ${SPECIES} == "ll" ] && [ ${POPULATION} != "ki" ] && [ ${POPULATION} != "po" ] && [ ${POPULATION} != "no" ]
```
to only process lynx lynx samples and avoid repeating the populations that Dani already processed (polonia,noruega,kirov)

It will be run on CNAG fastq folders (LYNX_XX) this way:
```
./LL_CNAG_LyCa_mapping_launcher_cesga.sh <path/to/folder/LYNX_XX/path/to/fastqs>
```
This script will check the above conditions and sbatch another script for the first steps of the mapping process (0.Mapping-executables/LL_CNAG_LyCaRef_mapping_step1_cesga.sh).

### LYNX_09
```
./LL_CNAG_LyCa_mapping_launcher_cesga.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_09
launching C6DUUANXX_2_21nf mapping of sample c_ll_vl_0107
Submitted batch job 3725584
launching C6DV6ANXX_1_21nf mapping of sample c_ll_vl_0107
Submitted batch job 3725585
launching C6DUUANXX_1_23nf mapping of sample c_ll_vl_0110
Submitted batch job 3725586
launching C6DV6ANXX_7_5nf mapping of sample c_ll_vl_0108
Submitted batch job 3726612
launching C6DUUANXX_2_22nf mapping of sample c_ll_vl_0109
Submitted batch job 3725588
launching C6DV6ANXX_1_23nf mapping of sample c_ll_vl_0110
Submitted batch job 3725589
```
### LYNX_13
```
./LL_CNAG_LyCa_mapping_launcher_cesga.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_13/20170127/FASTQ
launching C9KH1ANXX_5_13nf mapping of sample c_ll_ya_0147
Submitted batch job 3725590
launching C9KJ0ANXX_1_22nf mapping of sample c_ll_vl_0113
Submitted batch job 3725591
launching CA2W6ANXX_4_16nf mapping of sample c_ll_cr_0206
Submitted batch job 3725592
launching C9KH3ANXX_7_10nf mapping of sample c_ll_ya_0139
Submitted batch job 3725593
launching CA5U3ANXX_2_22nf mapping of sample c_ll_vl_0113
Submitted batch job 3725594
launching CA5U3ANXX_2_16nf mapping of sample c_ll_cr_0206
Submitted batch job 3725595
launching C9KH1ANXX_7_27nf mapping of sample c_ll_cr_0209
Submitted batch job 3725596
launching CA2W6ANXX_4_18nf mapping of sample c_ll_cr_0208
Submitted batch job 3725597
launching C9KH3ANXX_7_15nf mapping of sample c_ll_ya_0143
Submitted batch job 3725598
launching C9KH1ANXX_5_21nf mapping of sample c_ll_ya_0138
Submitted batch job 3725599
launching C9KH1ANXX_7_14nf mapping of sample c_ll_ya_0145
Submitted batch job 3725600
launching CA5U3ANXX_2_20nf mapping of sample c_ll_cr_0207
Submitted batch job 3725601
launching CA5U3ANXX_2_19nf mapping of sample c_ll_cr_0205
Submitted batch job 3725602
launching C9KH1ANXX_5_10nf mapping of sample c_ll_ya_0139
Submitted batch job 3725603
launching C9KH3ANXX_7_12nf mapping of sample c_ll_ya_0142
Submitted batch job 3725604
launching C9KH1ANXX_7_25nf mapping of sample c_ll_vl_0128
Submitted batch job 3725605
launching C9KH1ANXX_5_15nf mapping of sample c_ll_ya_0143
Submitted batch job 3725606
launching C9KH3ANXX_7_11nf mapping of sample c_ll_ya_0140
Submitted batch job 3725607
launching C9KH3ANXX_7_14nf mapping of sample c_ll_ya_0145
Submitted batch job 3725608
launching C9KJ0ANXX_4_19nf mapping of sample c_ll_cr_0205
Submitted batch job 3725609
launching C9KH3ANXX_8_27nf mapping of sample c_ll_cr_0209
Submitted batch job 3725610
launching C9KH1ANXX_5_12nf mapping of sample c_ll_ya_0142
Submitted batch job 3725611
launching CA5U3ANXX_2_18nf mapping of sample c_ll_cr_0208
Submitted batch job 3725612
launching C9KJ0ANXX_3_20nf mapping of sample c_ll_cr_0207
Submitted batch job 3725613
launching C9KH1ANXX_5_11nf mapping of sample c_ll_ya_0140
Submitted batch job 3725614
launching C9KH3ANXX_7_13nf mapping of sample c_ll_ya_0147
Submitted batch job 3725615
launching C9KH3ANXX_8_25nf mapping of sample c_ll_vl_0128
Submitted batch job 3725616
launching C9KJ0ANXX_2_23nf mapping of sample c_ll_vl_0132
Submitted batch job 3725617
launching CA5U3ANXX_2_23nf mapping of sample c_ll_vl_0132
Submitted batch job 3725618
launching C9KH3ANXX_7_21nf mapping of sample c_ll_ya_0138
Submitted batch job 3725619
```
### LYNX_15
```
./LL_CNAG_LyCa_mapping_launcher_cesga.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_15/LYNX_15/20170206/FASTQ
launching C9KH1ANXX_8_18nf mapping of sample c_ll_tu_0166
Submitted batch job 3725620
launching CA3D2ANXX_5_1nf mapping of sample c_ll_og_0181
Submitted batch job 3725621
launching C9KH3ANXX_8_11nf mapping of sample c_ll_la_0044
Submitted batch job 3725622
launching C9KH3ANXX_8_7nf mapping of sample c_ll_la_0053
Submitted batch job 3725623
launching C9KH1ANXX_7_1nf mapping of sample c_ll_to_0191
Submitted batch job 3725624
launching CAABGANXX_5_21nf mapping of sample c_ll_la_0052
Submitted batch job 3725625
launching C9KH1ANXX_8_13nf mapping of sample c_ll_tu_0158
Submitted batch job 3725626
launching CAABGANXX_5_15nf mapping of sample c_ll_tu_0165
Submitted batch job 3725627
launching CA3D2ANXX_5_6nf mapping of sample c_ll_ka_0188
Submitted batch job 3725628
launching CA2W6ANXX_1_2nf mapping of sample c_ll_og_0187
Submitted batch job 3725629
launching CA3D2ANXX_6_8nf mapping of sample c_ll_la_0047
Submitted batch job 3725630
launching CA2W6ANXX_4_6nf mapping of sample c_ll_ka_0188
Submitted batch job 3725631
launching CAABGANXX_5_9nf mapping of sample c_ll_la_0048
Submitted batch job 3725632
launching CA2W6ANXX_2_7nf mapping of sample c_ll_to_0190
Submitted batch job 3725633
launching C9KH3ANXX_8_13nf mapping of sample c_ll_tu_0158
Submitted batch job 3725634
launching CA3D2ANXX_6_7nf mapping of sample c_ll_to_0190
Submitted batch job 3725635
launching CA2W6ANXX_1_4nf mapping of sample c_ll_ka_0186
Submitted batch job 3725636
launching CAABGANXX_5_19nf mapping of sample c_ll_tu_0153
Submitted batch job 3725637
launching C9KH1ANXX_8_15nf mapping of sample c_ll_tu_0165
Submitted batch job 3725638
launching CA3D2ANXX_5_4nf mapping of sample c_ll_ka_0186
Submitted batch job 3725639
launching C9KH3ANXX_8_10nf mapping of sample c_ll_la_0054
Submitted batch job 3725640
launching CAABGANXX_5_14nf mapping of sample c_ll_tu_0159
Submitted batch job 3725641
launching CA2W6ANXX_2_8nf mapping of sample c_ll_la_0047
Submitted batch job 3725642
launching C9KH1ANXX_8_14nf mapping of sample c_ll_tu_0159
Submitted batch job 3725643
launching CA2W6ANXX_2_5nf mapping of sample c_ll_ka_0189
Submitted batch job 3725644
launching C9KH3ANXX_7_1nf mapping of sample c_ll_to_0191
Submitted batch job 3725645
launching C9KH1ANXX_8_19nf mapping of sample c_ll_tu_0153
Submitted batch job 3725646
launching C9KH1ANXX_8_12nf mapping of sample c_ll_tu_0157
Submitted batch job 3725647
launching CA2W6ANXX_1_3nf mapping of sample c_ll_ka_0184
Submitted batch job 3725648
launching CA3D2ANXX_5_2nf mapping of sample c_ll_og_0187
Submitted batch job 3725649
launching C9KH1ANXX_7_10nf mapping of sample c_ll_la_0054
Submitted batch job 3725650
launching C9KH3ANXX_8_12nf mapping of sample c_ll_tu_0157
Submitted batch job 3725651
launching CA3D2ANXX_6_21nf mapping of sample c_ll_la_0052
Submitted batch job 3725652
launching CA3D2ANXX_5_3nf mapping of sample c_ll_ka_0184
Submitted batch job 3725653
launching CA3D2ANXX_6_9nf mapping of sample c_ll_la_0048
Submitted batch job 3725654
launching CA3D2ANXX_5_5nf mapping of sample c_ll_ka_0189
Submitted batch job 3725655
launching CA2W6ANXX_1_1nf mapping of sample c_ll_og_0181
Submitted batch job 3725656
launching CAABGANXX_5_18nf mapping of sample c_ll_tu_0166
Submitted batch job 3725657
launching C9KH1ANXX_8_11nf mapping of sample c_ll_la_0044
Submitted batch job 3725658
launching C9KH1ANXX_7_7nf mapping of sample c_ll_la_0053
Submitted batch job 3725659
```
### LYNX_16
```
./LL_CNAG_LyCa_mapping_launcher_cesga.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_16/20170206/FASTQ
launching CA3D2ANXX_6_27nf mapping of sample h_ll_ba_0215
Submitted batch job 3725660
launching CA2W6ANXX_4_25nf mapping of sample c_ll_ba_0216
Submitted batch job 3726945
launching CA3D2ANXX_6_23nf mapping of sample h_ll_ba_0214
Submitted batch job 3725662
launching CA3D2ANXX_6_25nf mapping of sample c_ll_ba_0216
Submitted batch job 3725663
launching CA2W6ANXX_4_27nf mapping of sample h_ll_ba_0215
Submitted batch job 3726944
launching CA2W6ANXX_4_23nf mapping of sample h_ll_ba_0214
Submitted batch job 3725665
```
### LYNX_20
```
./LL_CNAG_LyCa_mapping_launcher_cesga.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/LYNX_20/FASTQ
launching HY5WLDSXX_1_21UDI-idt-UMI mapping of sample c_ll_ca_0240
Submitted batch job 3725666
launching HY5WLDSXX_1_9UDI-idt-UMI mapping of sample c_ll_ba_0224
Submitted batch job 3725667
launching HY5FMDSXX_2_21UDI-idt-UMI mapping of sample c_ll_ca_0240
Submitted batch job 3725668
launching HY5WLDSXX_3_21UDI-idt-UMI mapping of sample c_ll_ca_0240
Submitted batch job 3725669
launching HY5FMDSXX_3_21UDI-idt-UMI mapping of sample c_ll_ca_0240
Submitted batch job 3725670
launching HY5FMDSXX_1_21UDI-idt-UMI mapping of sample c_ll_ca_0240
Submitted batch job 3725671
launching HY5FMDSXX_4_9UDI-idt-UMI mapping of sample c_ll_ba_0224
Submitted batch job 3725672
launching HY5WLDSXX_2_21UDI-idt-UMI mapping of sample c_ll_ca_0240
Submitted batch job 3725673
launching HY5FMDSXX_2_9UDI-idt-UMI mapping of sample c_ll_ba_0224
Submitted batch job 3725674
launching HY5WLDSXX_4_21UDI-idt-UMI mapping of sample c_ll_ca_0240
Submitted batch job 3725675
launching HY5WLDSXX_3_9UDI-idt-UMI mapping of sample c_ll_ba_0224
Submitted batch job 3725676
launching HY5FMDSXX_4_21UDI-idt-UMI mapping of sample c_ll_ca_0240
Submitted batch job 3725677
launching HY5WLDSXX_2_9UDI-idt-UMI mapping of sample c_ll_ba_0224
Submitted batch job 3725678
launching HY5FMDSXX_3_9UDI-idt-UMI mapping of sample c_ll_ba_0224
Submitted batch job 3725679
launching HY5FMDSXX_1_9UDI-idt-UMI mapping of sample c_ll_ba_0224
Submitted batch job 3725680
launching HY5WLDSXX_4_9UDI-idt-UMI mapping of sample c_ll_ba_0224
Submitted batch job 3725681
```
### LYNX_18
```
./LL_CNAG_LyCa_mapping_launcher_cesga.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_18/20170828/FASTQ
launching CB84PANXX_7_152nfDI mapping of sample c_ll_ur_0194
Submitted batch job 3726616
launching CB84PANXX_7_164nfDI mapping of sample c_ll_ur_0195
Submitted batch job 3726617
launching CBCA6ANXX_7_176nfDI mapping of sample c_ll_ur_0200
Submitted batch job 3726618
launching CBCA6ANXX_8_117nfDI mapping of sample c_ll_ur_0199
Submitted batch job 3726619
launching CBCA6ANXX_8_105nfDI mapping of sample c_ll_ur_0203
Submitted batch job 3726620
launching CBCA6ANXX_7_188nfDI mapping of sample c_ll_ur_0196
Submitted batch job 3726621
```
### LYNX_21
Because LYNX_21 samples have been trimmed with Trimmomatic (some had adapter content problems), I wrote a modified script for step 1 (0.Mapping-executables/LYNX21_LyCaRef_mapping_step1_cesga.sh) and sbatched it "manually" with the following loop for all samples (divided in 2 as they would be more than the user maximum on CESGA)
```
firsthalf_FASTQ_list=($(ls /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/LYNX_21/FASTQ/*.fastq.gz | rev | cut -d'/' -f1 | rev | cut -d'_' -f1-3 | sort -u | head -56))

for fastqid in ${firsthalf_FASTQ_list[@]}
 do
 echo ${fastqid}
 sbatch LYNX21_LyCaRef_mapping_step1_cesga.sh ${fastqid} /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/LYNX_21_Trimmomatic/LYNX_21_trimmomatic
done

HY5FMDSXX_1_10UDI-idt-UMI
Submitted batch job 3767103
HY5FMDSXX_1_33UDI-idt-UMI
Submitted batch job 3767104
HY5FMDSXX_1_45UDI-idt-UMI
Submitted batch job 3767105
HY5FMDSXX_1_57UDI-idt-UMI
Submitted batch job 3767106
HY5FMDSXX_1_69UDI-idt-UMI
Submitted batch job 3767107
HY5FMDSXX_1_81UDI-idt-UMI
Submitted batch job 3767108
HY5FMDSXX_1_93UDI-idt-UMI
Submitted batch job 3767109
HY5FMDSXX_2_10UDI-idt-UMI
Submitted batch job 3767110
HY5FMDSXX_2_33UDI-idt-UMI
Submitted batch job 3767111
HY5FMDSXX_2_45UDI-idt-UMI
Submitted batch job 3767112
HY5FMDSXX_2_57UDI-idt-UMI
Submitted batch job 3767113
HY5FMDSXX_2_69UDI-idt-UMI
Submitted batch job 3767114
HY5FMDSXX_2_81UDI-idt-UMI
Submitted batch job 3767115
HY5FMDSXX_2_93UDI-idt-UMI
Submitted batch job 3767116
HY5FMDSXX_3_10UDI-idt-UMI
Submitted batch job 3767117
HY5FMDSXX_3_33UDI-idt-UMI
Submitted batch job 3767118
HY5FMDSXX_3_45UDI-idt-UMI
Submitted batch job 3767119
HY5FMDSXX_3_57UDI-idt-UMI
Submitted batch job 3767120
HY5FMDSXX_3_69UDI-idt-UMI
Submitted batch job 3767121
HY5FMDSXX_3_81UDI-idt-UMI
Submitted batch job 3767122
HY5FMDSXX_3_93UDI-idt-UMI
Submitted batch job 3767123
HY5FMDSXX_4_10UDI-idt-UMI
Submitted batch job 3767124
HY5FMDSXX_4_33UDI-idt-UMI
Submitted batch job 3767125
HY5FMDSXX_4_45UDI-idt-UMI
Submitted batch job 3767126
HY5FMDSXX_4_57UDI-idt-UMI
Submitted batch job 3767127
HY5FMDSXX_4_69UDI-idt-UMI
Submitted batch job 3767128
HY5FMDSXX_4_81UDI-idt-UMI
Submitted batch job 3767129
HY5FMDSXX_4_93UDI-idt-UMI
Submitted batch job 3767130
HY5JLDSXX_1_196UDI-idt-UMI
Submitted batch job 3767131
HY5JLDSXX_1_208UDI-idt-UMI
Submitted batch job 3767132
HY5JLDSXX_1_214UDI-idt-UMI
Submitted batch job 3767133
HY5JLDSXX_1_215UDI-idt-UMI
Submitted batch job 3767134
HY5JLDSXX_1_250UDI-idt-UMI
Submitted batch job 3767135
HY5JLDSXX_2_196UDI-idt-UMI
Submitted batch job 3767136
HY5JLDSXX_2_208UDI-idt-UMI
Submitted batch job 3767137
HY5JLDSXX_2_214UDI-idt-UMI
Submitted batch job 3767138
HY5JLDSXX_2_215UDI-idt-UMI
Submitted batch job 3767139
HY5JLDSXX_2_250UDI-idt-UMI
Submitted batch job 3767140
HY5JLDSXX_3_196UDI-idt-UMI
Submitted batch job 3767141
HY5JLDSXX_3_208UDI-idt-UMI
Submitted batch job 3767142
HY5JLDSXX_3_214UDI-idt-UMI
Submitted batch job 3767143
HY5JLDSXX_3_215UDI-idt-UMI
Submitted batch job 3767144
HY5JLDSXX_3_250UDI-idt-UMI
Submitted batch job 3767145
HY5JLDSXX_4_196UDI-idt-UMI
Submitted batch job 3767146
HY5JLDSXX_4_208UDI-idt-UMI
Submitted batch job 3767147
HY5JLDSXX_4_214UDI-idt-UMI
Submitted batch job 3767148
HY5JLDSXX_4_215UDI-idt-UMI
Submitted batch job 3767149
HY5JLDSXX_4_250UDI-idt-UMI
Submitted batch job 3767150
HY5WLDSXX_1_10UDI-idt-UMI
Submitted batch job 3767151
HY5WLDSXX_1_202UDI-idt-UMI
Submitted batch job 3767152
HY5WLDSXX_1_203UDI-idt-UMI
Submitted batch job 3767153
HY5WLDSXX_1_214UDI-idt-UMI
Submitted batch job 3767154
HY5WLDSXX_1_215UDI-idt-UMI
Submitted batch job 3767155
HY5WLDSXX_1_226UDI-idt-UMI
Submitted batch job 3767156
HY5WLDSXX_1_238UDI-idt-UMI
Submitted batch job 3767157
HY5WLDSXX_1_262UDI-idt-UMI
Submitted batch job 3767158

secondhalf_FASTQ_list=($(ls /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/LYNX_21/FASTQ/*.fastq.gz | rev | cut -d'/' -f1 | rev | cut -d'_' -f1-3 | sort -u | tail -56))

for fastqid in ${secondhalf_FASTQ_list[@]}
 do
 echo ${fastqid}
 sbatch LYNX21_LyCaRef_mapping_step1_cesga.sh ${fastqid} /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/LYNX_21_Trimmomatic/LYNX_21_trimmomatic
done

HY5WLDSXX_1_274UDI-idt-UMI
Submitted batch job 3767165
HY5WLDSXX_1_286UDI-idt-UMI
Submitted batch job 3767166
HY5WLDSXX_1_33UDI-idt-UMI
Submitted batch job 3767167
HY5WLDSXX_1_45UDI-idt-UMI
Submitted batch job 3767168
HY5WLDSXX_1_57UDI-idt-UMI
Submitted batch job 3767169
HY5WLDSXX_1_69UDI-idt-UMI
Submitted batch job 3767170
HY5WLDSXX_1_81UDI-idt-UMI
Submitted batch job 3767171
HY5WLDSXX_1_93UDI-idt-UMI
Submitted batch job 3767172
HY5WLDSXX_2_10UDI-idt-UMI
Submitted batch job 3767173
HY5WLDSXX_2_202UDI-idt-UMI
Submitted batch job 3767174
HY5WLDSXX_2_203UDI-idt-UMI
Submitted batch job 3767175
HY5WLDSXX_2_214UDI-idt-UMI
Submitted batch job 3767176
HY5WLDSXX_2_215UDI-idt-UMI
Submitted batch job 3767177
HY5WLDSXX_2_226UDI-idt-UMI
Submitted batch job 3767178
HY5WLDSXX_2_238UDI-idt-UMI
Submitted batch job 3767179
HY5WLDSXX_2_262UDI-idt-UMI
Submitted batch job 3767180
HY5WLDSXX_2_274UDI-idt-UMI
Submitted batch job 3767181
HY5WLDSXX_2_286UDI-idt-UMI
Submitted batch job 3767182
HY5WLDSXX_2_33UDI-idt-UMI
Submitted batch job 3767183
HY5WLDSXX_2_45UDI-idt-UMI
Submitted batch job 3767184
HY5WLDSXX_2_57UDI-idt-UMI
Submitted batch job 3767185
HY5WLDSXX_2_69UDI-idt-UMI
Submitted batch job 3767186
HY5WLDSXX_2_81UDI-idt-UMI
Submitted batch job 3767187
HY5WLDSXX_2_93UDI-idt-UMI
Submitted batch job 3767188
HY5WLDSXX_3_10UDI-idt-UMI
Submitted batch job 3767189
HY5WLDSXX_3_202UDI-idt-UMI
Submitted batch job 3767190
HY5WLDSXX_3_203UDI-idt-UMI
Submitted batch job 3767191
HY5WLDSXX_3_214UDI-idt-UMI
Submitted batch job 3767192
HY5WLDSXX_3_215UDI-idt-UMI
Submitted batch job 3767193
HY5WLDSXX_3_226UDI-idt-UMI
Submitted batch job 3767194
HY5WLDSXX_3_238UDI-idt-UMI
Submitted batch job 3767195
HY5WLDSXX_3_262UDI-idt-UMI
Submitted batch job 3767196
HY5WLDSXX_3_274UDI-idt-UMI
Submitted batch job 3767197
HY5WLDSXX_3_286UDI-idt-UMI
Submitted batch job 3767198
HY5WLDSXX_3_33UDI-idt-UMI
Submitted batch job 3767199
HY5WLDSXX_3_45UDI-idt-UMI
Submitted batch job 3767200
HY5WLDSXX_3_57UDI-idt-UMI
Submitted batch job 3767201
HY5WLDSXX_3_69UDI-idt-UMI
Submitted batch job 3767202
HY5WLDSXX_3_81UDI-idt-UMI
Submitted batch job 3767203
HY5WLDSXX_3_93UDI-idt-UMI
Submitted batch job 3767204
HY5WLDSXX_4_10UDI-idt-UMI
Submitted batch job 3767205
HY5WLDSXX_4_202UDI-idt-UMI
Submitted batch job 3767206
HY5WLDSXX_4_203UDI-idt-UMI
Submitted batch job 3767207
HY5WLDSXX_4_214UDI-idt-UMI
Submitted batch job 3767208
HY5WLDSXX_4_215UDI-idt-UMI
Submitted batch job 3767209
HY5WLDSXX_4_226UDI-idt-UMI
Submitted batch job 3767210
HY5WLDSXX_4_238UDI-idt-UMI
Submitted batch job 3767211
HY5WLDSXX_4_262UDI-idt-UMI
Submitted batch job 3767212
HY5WLDSXX_4_274UDI-idt-UMI
Submitted batch job 3767213
HY5WLDSXX_4_286UDI-idt-UMI
Submitted batch job 3767214
HY5WLDSXX_4_33UDI-idt-UMI
Submitted batch job 3767215
HY5WLDSXX_4_45UDI-idt-UMI
Submitted batch job 3767216
HY5WLDSXX_4_57UDI-idt-UMI
Submitted batch job 3767217
HY5WLDSXX_4_69UDI-idt-UMI
Submitted batch job 3767218
HY5WLDSXX_4_81UDI-idt-UMI
Submitted batch job 3767219
HY5WLDSXX_4_93UDI-idt-UMI
Submitted batch job 3767220
```
### MACROGEN
Because MACROGEN samples have slightly different format for the fastq file name, I wrote a modified script for step 1 (0.Mapping-executables/LL_MACROGEN_LyCaRef_mapping_step1_cesga.sh) and sbatched it "manually" with the following loop for all samples (except c_ll_ki_0090 that was already mapped by Dani):
```
folder=/mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/MAGROGEN
for sample in $(ls ${folder} | grep LL | grep -v LL90 | rev | cut -d'/' -f 1 | rev | cut -d '_' -f1 | uniq)
 do
  echo "mapping ${sample} from MACROGEN"
  sbatch LL_MACROGEN_LyCaRef_mapping_step1_cesga.sh ${sample} ${folder}
done

mapping LL112 from MACROGEN
Submitted batch job 3728957
mapping LL146 from MACROGEN
Submitted batch job 3728958
mapping LL212 from MACROGEN
Submitted batch job 3728959
```

## Step 2

Step 2 will consist of just one script that will be sbatched once for each sample (LL_CNAG_LyCaRef_mapping_step2_cesga.sh). This script will take all BAMs from that sample and merge them (if there are 2 or more). Then will complete the rest of the BAM post-processing steps.
```
cd $LUSTRE/LL_selection
for sample in $(ls LyCaRef_bams/*.bam | tr ' ' '\n' | rev | cut -d'/' -f1 | rev | cut -d'_' -f1-4 | sort -u)
 do
 echo "step 2 of $sample mapping"
 sbatch LL_CNAG_LyCaRef_mapping_step2_cesga.sh $sample
done

step 2 of c_ll_ba_0216 mapping
Submitted batch job 3738400
step 2 of c_ll_ba_0224 mapping
Submitted batch job 3738401
step 2 of c_ll_ca_0240 mapping
Submitted batch job 3738402
step 2 of c_ll_cr_0205 mapping
Submitted batch job 3738403
step 2 of c_ll_cr_0206 mapping
Submitted batch job 3738404
step 2 of c_ll_cr_0207 mapping
Submitted batch job 3738405
step 2 of c_ll_cr_0208 mapping
Submitted batch job 3738406
step 2 of c_ll_cr_0209 mapping
Submitted batch job 3738407
step 2 of c_ll_cr_0212 mapping
Submitted batch job 3738408
step 2 of c_ll_ka_0184 mapping
Submitted batch job 3738409
step 2 of c_ll_ka_0186 mapping
Submitted batch job 3738410
step 2 of c_ll_ka_0188 mapping
Submitted batch job 3738411
step 2 of c_ll_ka_0189 mapping
Submitted batch job 3738412
step 2 of c_ll_la_0044 mapping
Submitted batch job 3738413
step 2 of c_ll_la_0047 mapping
Submitted batch job 3738414
step 2 of c_ll_la_0048 mapping
Submitted batch job 3738415
step 2 of c_ll_la_0052 mapping
Submitted batch job 3738416
step 2 of c_ll_la_0053 mapping
Submitted batch job 3738417
step 2 of c_ll_la_0054 mapping
Submitted batch job 3738418
step 2 of c_ll_og_0181 mapping
Submitted batch job 3738419
step 2 of c_ll_og_0187 mapping
Submitted batch job 3738420
step 2 of c_ll_to_0190 mapping
Submitted batch job 3738421
step 2 of c_ll_to_0191 mapping
Submitted batch job 3738422
step 2 of c_ll_tu_0153 mapping
Submitted batch job 3738423
step 2 of c_ll_tu_0157 mapping
Submitted batch job 3738424
step 2 of c_ll_tu_0158 mapping
Submitted batch job 3738425
step 2 of c_ll_tu_0159 mapping
Submitted batch job 3738426
step 2 of c_ll_tu_0165 mapping
Submitted batch job 3738427
step 2 of c_ll_tu_0166 mapping
Submitted batch job 3738428
step 2 of c_ll_ur_0194 mapping
Submitted batch job 3738429
step 2 of c_ll_ur_0195 mapping
Submitted batch job 3738430
step 2 of c_ll_ur_0196 mapping
Submitted batch job 3738431
step 2 of c_ll_ur_0199 mapping
Submitted batch job 3738432
step 2 of c_ll_ur_0200 mapping
Submitted batch job 3738433
step 2 of c_ll_ur_0203 mapping
Submitted batch job 3738434
step 2 of c_ll_vl_0107 mapping
Submitted batch job 3738435
step 2 of c_ll_vl_0108 mapping
Submitted batch job 3738436
step 2 of c_ll_vl_0109 mapping
Submitted batch job 3738437
step 2 of c_ll_vl_0110 mapping
Submitted batch job 3738438
step 2 of c_ll_vl_0112 mapping
Submitted batch job 3738439
step 2 of c_ll_vl_0113 mapping
Submitted batch job 3738440
step 2 of c_ll_vl_0128 mapping
Submitted batch job 3738441
step 2 of c_ll_vl_0132 mapping
Submitted batch job 3738442
step 2 of c_ll_ya_0138 mapping
Submitted batch job 3738443
step 2 of c_ll_ya_0139 mapping
Submitted batch job 3738444
step 2 of c_ll_ya_0140 mapping
Submitted batch job 3738445
step 2 of c_ll_ya_0142 mapping
Submitted batch job 3738446
step 2 of c_ll_ya_0143 mapping
Submitted batch job 3738447
step 2 of c_ll_ya_0145 mapping
Submitted batch job 3738448
step 2 of c_ll_ya_0146 mapping
Submitted batch job 3738449
step 2 of c_ll_ya_0147 mapping
Submitted batch job 3738450
step 2 of h_ll_ba_0214 mapping
Submitted batch job 3738451
step 2 of h_ll_ba_0215 mapping
Submitted batch job 3738452
```
I had a problem with samples with only one BAM (the script has been corrected). I will sbatch again step 2 only for those samples (the ones that don't have the final BAM):
```
cd $LUSTRE/LL_selection
for sample in $(ls LyCaRef_bams/*.bam | tr ' ' '\n' | grep -v "_indelrealigner.bam" | rev | cut -d'/' -f1 | rev | cut -d'_' -f1-4 | sort -u)
 do
  echo "step 2 of $sample mapping"
  sbatch LL_CNAG_LyCaRef_mapping_step2_cesga.sh $sample
done

step 2 of c_ll_cr_0212 mapping
Submitted batch job 3741574
step 2 of c_ll_ur_0194 mapping
Submitted batch job 3741575
step 2 of c_ll_ur_0195 mapping
Submitted batch job 3741576
step 2 of c_ll_ur_0196 mapping
Submitted batch job 3741577
step 2 of c_ll_ur_0199 mapping
Submitted batch job 3741578
step 2 of c_ll_ur_0200 mapping
Submitted batch job 3741579
step 2 of c_ll_ur_0203 mapping
Submitted batch job 3741580
step 2 of c_ll_vl_0108 mapping
Submitted batch job 3741581
step 2 of c_ll_vl_0109 mapping
Submitted batch job 3741582
step 2 of c_ll_vl_0112 mapping
Submitted batch job 3741583
step 2 of c_ll_ya_0146 mapping
Submitted batch job 3741584
```
And again for LYNX_21 samples:
```
for sample in $(ls LyCaRef_bams/*.bam | tr ' ' '\n' | grep -v "_indelrealigner.bam" | rev | cut -d'/' -f1 | rev | cut -d'_' -f1-4 | sort -u)
 do
  echo "step 2 of $sample mapping"
  sbatch LL_CNAG_LyCaRef_mapping_step2_cesga.sh $sample
done

step 2 of c_ll_ba_0226 mapping
Submitted batch job 3775517
step 2 of c_ll_ba_0227 mapping
Submitted batch job 3775518
step 2 of c_ll_ba_0228 mapping
Submitted batch job 3775519
step 2 of c_ll_ba_0229 mapping
Submitted batch job 3775520
step 2 of c_ll_ba_0230 mapping
Submitted batch job 3775521
step 2 of c_ll_ba_0233 mapping
Submitted batch job 3775522
step 2 of c_ll_ca_0241 mapping
Submitted batch job 3775523
step 2 of c_ll_ca_0242 mapping
Submitted batch job 3775524
step 2 of c_ll_ca_0243 mapping
Submitted batch job 3775525
step 2 of c_ll_ca_0244 mapping
Submitted batch job 3775526
step 2 of c_ll_ca_0245 mapping
Submitted batch job 3775527
step 2 of c_ll_ca_0247 mapping
Submitted batch job 3775528
step 2 of c_ll_ca_0248 mapping
Submitted batch job 3775529
step 2 of c_ll_ca_0249 mapping
Submitted batch job 3775530
step 2 of c_ll_ca_0252 mapping
Submitted batch job 3775531
step 2 of c_ll_ca_0253 mapping
Submitted batch job 3775532
step 2 of c_ll_ca_0254 mapping
Submitted batch job 3775533
step 2 of c_ll_ca_0259 mapping
Submitted batch job 3775534
step 2 of c_ll_ca_0260 mapping
Submitted batch job 3775535
```

## Getting the Mapping statistics

I wrote a script to get the mapping statistics for all samples from a single fastq folder. This way I can easily get information from the original fastqs. It works similarly as the step 1 launcher, with one script (0.Mapping-executables/mapstats_tablemaker_LyCaRef_LAUNCHER.sh) used to sbatch a different script (0.Mapping-executables/mapstats_tablemaker_LyCaRef_CNAG.sh) for every sample within a folder.

This only works properly for fastq folders with CNAG typical name patterns.
```
cd $LUSTRE/LL_selection

### BARCODE LYNX_06_08:
./mapstats_tablemaker_LyCaRef_LAUNCHER.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_06_08

launching mapping statistics of sample c_ll_ki_0091
Submitted batch job 3787779
launching mapping statistics of sample c_ll_ki_0092
Submitted batch job 3787780
launching mapping statistics of sample c_ll_ki_0093
Submitted batch job 3787781
launching mapping statistics of sample c_ll_ki_0094
Submitted batch job 3787782
launching mapping statistics of sample c_ll_ki_0095
Submitted batch job 3787783
launching mapping statistics of sample c_ll_ki_0096
Submitted batch job 3787784
launching mapping statistics of sample c_ll_ki_0097
Submitted batch job 3787785
launching mapping statistics of sample c_ll_ki_0098
Submitted batch job 3787786
launching mapping statistics of sample c_ll_ki_0099
Submitted batch job 3787787
launching mapping statistics of sample c_ll_ki_0100
Submitted batch job 3787788
launching mapping statistics of sample c_ll_ki_0101
Submitted batch job 3787789
launching mapping statistics of sample c_ll_ki_0102
Submitted batch job 3787790
launching mapping statistics of sample c_ll_no_0075
Submitted batch job 3787791
launching mapping statistics of sample c_ll_no_0076
Submitted batch job 3787792
launching mapping statistics of sample c_ll_no_0077
Submitted batch job 3787793
launching mapping statistics of sample c_ll_no_0078
Submitted batch job 3787794
launching mapping statistics of sample c_ll_no_0079
Submitted batch job 3787795
launching mapping statistics of sample c_ll_no_0080
Submitted batch job 3787796
launching mapping statistics of sample c_ll_no_0081
Submitted batch job 3787797
launching mapping statistics of sample c_ll_no_0082
Submitted batch job 3787798

### LYNX_09
./mapstats_tablemaker_LyCaRef_LAUNCHER.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_09

launching mapping statistics of sample c_ll_po_0001
Submitted batch job 3787313
launching mapping statistics of sample c_ll_po_0002
Submitted batch job 3787314
launching mapping statistics of sample c_ll_po_0003
Submitted batch job 3787315
launching mapping statistics of sample c_ll_po_0011
Submitted batch job 3787316
launching mapping statistics of sample c_ll_po_0014
Submitted batch job 3787317
launching mapping statistics of sample c_ll_po_0019
Submitted batch job 3787318
launching mapping statistics of sample c_ll_po_0105
Submitted batch job 3787319
launching mapping statistics of sample c_ll_po_0106
Submitted batch job 3787320
launching mapping statistics of sample c_ll_vl_0107
Submitted batch job 3787321
launching mapping statistics of sample c_ll_vl_0108
Submitted batch job 3787322
launching mapping statistics of sample c_ll_vl_0109
Submitted batch job 3787323
launching mapping statistics of sample c_ll_vl_0110
Submitted batch job 3787324

# LYNX 13
./mapstats_tablemaker_LyCaRef_LAUNCHER.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_13/20170127/FASTQ

launching mapping statistics of sample c_ll_cr_0205
Submitted batch job 3783002
launching mapping statistics of sample c_ll_cr_0206
Submitted batch job 3783003
launching mapping statistics of sample c_ll_cr_0207
Submitted batch job 3783004
launching mapping statistics of sample c_ll_cr_0208
Submitted batch job 3783005
launching mapping statistics of sample c_ll_cr_0209
Submitted batch job 3783006
launching mapping statistics of sample c_ll_vl_0113
Submitted batch job 3783007
launching mapping statistics of sample c_ll_vl_0128
Submitted batch job 3783008
launching mapping statistics of sample c_ll_vl_0132
Submitted batch job 3783009
launching mapping statistics of sample c_ll_ya_0138
Submitted batch job 3783010
launching mapping statistics of sample c_ll_ya_0139
Submitted batch job 3783011
launching mapping statistics of sample c_ll_ya_0140
Submitted batch job 3783012
launching mapping statistics of sample c_ll_ya_0142
Submitted batch job 3783013
launching mapping statistics of sample c_ll_ya_0143
Submitted batch job 3783014
launching mapping statistics of sample c_ll_ya_0145
Submitted batch job 3783015
launching mapping statistics of sample c_ll_ya_0147
Submitted batch job 3783016

### LYNX_15
./mapstats_tablemaker_LyCaRef_LAUNCHER.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_15/LYNX_15/20170206/FASTQ

launching mapping statistics of sample c_ll_ka_0184
Submitted batch job 3787325
launching mapping statistics of sample c_ll_ka_0186
Submitted batch job 3787326
launching mapping statistics of sample c_ll_ka_0188
Submitted batch job 3787327
launching mapping statistics of sample c_ll_ka_0189
Submitted batch job 3787328
launching mapping statistics of sample c_ll_la_0044
Submitted batch job 3787329
launching mapping statistics of sample c_ll_la_0047
Submitted batch job 3787330
launching mapping statistics of sample c_ll_la_0048
Submitted batch job 3787331
launching mapping statistics of sample c_ll_la_0052
Submitted batch job 3787332
launching mapping statistics of sample c_ll_la_0053
Submitted batch job 3787333
launching mapping statistics of sample c_ll_la_0054
Submitted batch job 3787334
launching mapping statistics of sample c_ll_og_0181
Submitted batch job 3787335
launching mapping statistics of sample c_ll_og_0187
Submitted batch job 3787336
launching mapping statistics of sample c_ll_to_0190
Submitted batch job 3787337
launching mapping statistics of sample c_ll_to_0191
Submitted batch job 3787338
launching mapping statistics of sample c_ll_tu_0153
Submitted batch job 3787339
launching mapping statistics of sample c_ll_tu_0157
Submitted batch job 3787340
launching mapping statistics of sample c_ll_tu_0158
Submitted batch job 3787341
launching mapping statistics of sample c_ll_tu_0159
Submitted batch job 3787342
launching mapping statistics of sample c_ll_tu_0165
Submitted batch job 3787343
launching mapping statistics of sample c_ll_tu_0166
Submitted batch job 3787344

### LYNX_16
./mapstats_tablemaker_LyCaRef_LAUNCHER.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_16/20170206/FASTQ

launching mapping statistics of sample c_ll_ba_0216
Submitted batch job 3787350
launching mapping statistics of sample h_ll_ba_0214
Submitted batch job 3787351
launching mapping statistics of sample h_ll_ba_0215
Submitted batch job 3787352

### LYNX_20
./mapstats_tablemaker_LyCaRef_LAUNCHER.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/LYNX_20/FASTQ

launching mapping statistics of sample c_ll_ba_0224
Submitted batch job 3787345
launching mapping statistics of sample c_ll_ca_0240
Submitted batch job 3787347


### LYNX_18
./mapstats_tablemaker_LyCaRef_LAUNCHER.sh /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/genomes_lynx_5x/LYNX_18/20170828/FASTQ

launching mapping statistics of sample c_ll_ur_0194
Submitted batch job 3787355
launching mapping statistics of sample c_ll_ur_0195
Submitted batch job 3787356
launching mapping statistics of sample c_ll_ur_0196
Submitted batch job 3787357
launching mapping statistics of sample c_ll_ur_0199
Submitted batch job 3787358
launching mapping statistics of sample c_ll_ur_0200
Submitted batch job 3787359
launching mapping statistics of sample c_ll_ur_0203
Submitted batch job 3787360

```
For LYNX_21 samples I wrote a slightly modified script (0.Mapping-executables/mapstats_tablemaker_LyCaRef_LYNX21.sh) and sbatched it like this:
```
declare -A BARCODEID
# BARCODE LYNX_21
BARCODEID+=(["HY5FMDSXX_1_33UDI-idt-UMI"]="c_ll_ba_0227" ["HY5FMDSXX_1_45UDI-idt-UMI"]="c_ll_ba_0228" ["HY5FMDSXX_1_57UDI-idt-UMI"]="c_ll_ba_0230" ["HY5FMDSXX_1_69UDI-idt-UMI"]="c_ll_ba_0233" ["HY5FMDSXX_1_81UDI-idt-UMI"]="c_ll_ca_0241" ["HY5FMDSXX_1_93UDI-idt-UMI"]="c_ll_ca_0242" ["HY5FMDSXX_1_10UDI-idt-UMI"]="c_ll_ca_0243" ["HY5FMDSXX_2_33UDI-idt-UMI"]="c_ll_ba_0227" ["HY5FMDSXX_2_45UDI-idt-UMI"]="c_ll_ba_0228" ["HY5FMDSXX_2_57UDI-idt-UMI"]="c_ll_ba_0230" ["HY5FMDSXX_2_69UDI-idt-UMI"]="c_ll_ba_0233" ["HY5FMDSXX_2_81UDI-idt-UMI"]="c_ll_ca_0241" ["HY5FMDSXX_2_93UDI-idt-UMI"]="c_ll_ca_0242" ["HY5FMDSXX_2_10UDI-idt-UMI"]="c_ll_ca_0243" ["HY5FMDSXX_3_33UDI-idt-UMI"]="c_ll_ba_0227" ["HY5FMDSXX_3_45UDI-idt-UMI"]="c_ll_ba_0228" ["HY5FMDSXX_3_57UDI-idt-UMI"]="c_ll_ba_0230" ["HY5FMDSXX_3_69UDI-idt-UMI"]="c_ll_ba_0233" ["HY5FMDSXX_3_81UDI-idt-UMI"]="c_ll_ca_0241" ["HY5FMDSXX_3_93UDI-idt-UMI"]="c_ll_ca_0242" ["HY5FMDSXX_3_10UDI-idt-UMI"]="c_ll_ca_0243" ["HY5FMDSXX_4_33UDI-idt-UMI"]="c_ll_ba_0227" ["HY5FMDSXX_4_45UDI-idt-UMI"]="c_ll_ba_0228" ["HY5FMDSXX_4_57UDI-idt-UMI"]="c_ll_ba_0230" ["HY5FMDSXX_4_69UDI-idt-UMI"]="c_ll_ba_0233" ["HY5FMDSXX_4_81UDI-idt-UMI"]="c_ll_ca_0241" ["HY5FMDSXX_4_93UDI-idt-UMI"]="c_ll_ca_0242" ["HY5FMDSXX_4_10UDI-idt-UMI"]="c_ll_ca_0243" ["HY5JLDSXX_1_214UDI-idt-UMI"]="c_ll_ca_0245" ["HY5JLDSXX_1_250UDI-idt-UMI"]="c_ll_ca_0249" ["HY5JLDSXX_1_215UDI-idt-UMI"]="c_ll_ca_0260" ["HY5JLDSXX_1_196UDI-idt-UMI"]="c_ll_ba_0226" ["HY5JLDSXX_1_208UDI-idt-UMI"]="c_ll_ba_0229" ["HY5JLDSXX_2_214UDI-idt-UMI"]="c_ll_ca_0245" ["HY5JLDSXX_2_250UDI-idt-UMI"]="c_ll_ca_0249" ["HY5JLDSXX_2_215UDI-idt-UMI"]="c_ll_ca_0260" ["HY5JLDSXX_2_196UDI-idt-UMI"]="c_ll_ba_0226" ["HY5JLDSXX_2_208UDI-idt-UMI"]="c_ll_ba_0229" ["HY5JLDSXX_3_214UDI-idt-UMI"]="c_ll_ca_0245" ["HY5JLDSXX_3_250UDI-idt-UMI"]="c_ll_ca_0249" ["HY5JLDSXX_3_215UDI-idt-UMI"]="c_ll_ca_0260" ["HY5JLDSXX_3_196UDI-idt-UMI"]="c_ll_ba_0226" ["HY5JLDSXX_3_208UDI-idt-UMI"]="c_ll_ba_0229" ["HY5JLDSXX_4_214UDI-idt-UMI"]="c_ll_ca_0245" ["HY5JLDSXX_4_250UDI-idt-UMI"]="c_ll_ca_0249" ["HY5JLDSXX_4_215UDI-idt-UMI"]="c_ll_ca_0260" ["HY5JLDSXX_4_196UDI-idt-UMI"]="c_ll_ba_0226" ["HY5JLDSXX_4_208UDI-idt-UMI"]="c_ll_ba_0229" ["HY5WLDSXX_1_33UDI-idt-UMI"]="c_ll_ba_0227" ["HY5WLDSXX_1_45UDI-idt-UMI"]="c_ll_ba_0228" ["HY5WLDSXX_1_57UDI-idt-UMI"]="c_ll_ba_0230" ["HY5WLDSXX_1_69UDI-idt-UMI"]="c_ll_ba_0233" ["HY5WLDSXX_1_81UDI-idt-UMI"]="c_ll_ca_0241" ["HY5WLDSXX_1_93UDI-idt-UMI"]="c_ll_ca_0242" ["HY5WLDSXX_1_10UDI-idt-UMI"]="c_ll_ca_0243" ["HY5WLDSXX_1_202UDI-idt-UMI"]="c_ll_ca_0244" ["HY5WLDSXX_1_214UDI-idt-UMI"]="c_ll_ca_0245" ["HY5WLDSXX_1_226UDI-idt-UMI"]="c_ll_ca_0247" ["HY5WLDSXX_1_238UDI-idt-UMI"]="c_ll_ca_0248" ["HY5WLDSXX_1_262UDI-idt-UMI"]="c_ll_ca_0252" ["HY5WLDSXX_1_274UDI-idt-UMI"]="c_ll_ca_0253" ["HY5WLDSXX_1_286UDI-idt-UMI"]="c_ll_ca_0254" ["HY5WLDSXX_1_203UDI-idt-UMI"]="c_ll_ca_0259" ["HY5WLDSXX_1_215UDI-idt-UMI"]="c_ll_ca_0260" ["HY5WLDSXX_2_33UDI-idt-UMI"]="c_ll_ba_0227" ["HY5WLDSXX_2_45UDI-idt-UMI"]="c_ll_ba_0228" ["HY5WLDSXX_2_57UDI-idt-UMI"]="c_ll_ba_0230" ["HY5WLDSXX_2_69UDI-idt-UMI"]="c_ll_ba_0233" ["HY5WLDSXX_2_81UDI-idt-UMI"]="c_ll_ca_0241" ["HY5WLDSXX_2_93UDI-idt-UMI"]="c_ll_ca_0242" ["HY5WLDSXX_2_10UDI-idt-UMI"]="c_ll_ca_0243" ["HY5WLDSXX_2_202UDI-idt-UMI"]="c_ll_ca_0244" ["HY5WLDSXX_2_214UDI-idt-UMI"]="c_ll_ca_0245" ["HY5WLDSXX_2_226UDI-idt-UMI"]="c_ll_ca_0247" ["HY5WLDSXX_2_238UDI-idt-UMI"]="c_ll_ca_0248" ["HY5WLDSXX_2_262UDI-idt-UMI"]="c_ll_ca_0252" ["HY5WLDSXX_2_274UDI-idt-UMI"]="c_ll_ca_0253" ["HY5WLDSXX_2_286UDI-idt-UMI"]="c_ll_ca_0254" ["HY5WLDSXX_2_203UDI-idt-UMI"]="c_ll_ca_0259" ["HY5WLDSXX_2_215UDI-idt-UMI"]="c_ll_ca_0260" ["HY5WLDSXX_3_33UDI-idt-UMI"]="c_ll_ba_0227" ["HY5WLDSXX_3_45UDI-idt-UMI"]="c_ll_ba_0228" ["HY5WLDSXX_3_57UDI-idt-UMI"]="c_ll_ba_0230" ["HY5WLDSXX_3_69UDI-idt-UMI"]="c_ll_ba_0233" ["HY5WLDSXX_3_81UDI-idt-UMI"]="c_ll_ca_0241" ["HY5WLDSXX_3_93UDI-idt-UMI"]="c_ll_ca_0242" ["HY5WLDSXX_3_10UDI-idt-UMI"]="c_ll_ca_0243" ["HY5WLDSXX_3_202UDI-idt-UMI"]="c_ll_ca_0244" ["HY5WLDSXX_3_214UDI-idt-UMI"]="c_ll_ca_0245" ["HY5WLDSXX_3_226UDI-idt-UMI"]="c_ll_ca_0247" ["HY5WLDSXX_3_238UDI-idt-UMI"]="c_ll_ca_0248" ["HY5WLDSXX_3_262UDI-idt-UMI"]="c_ll_ca_0252" ["HY5WLDSXX_3_274UDI-idt-UMI"]="c_ll_ca_0253" ["HY5WLDSXX_3_286UDI-idt-UMI"]="c_ll_ca_0254" ["HY5WLDSXX_3_203UDI-idt-UMI"]="c_ll_ca_0259" ["HY5WLDSXX_3_215UDI-idt-UMI"]="c_ll_ca_0260" ["HY5WLDSXX_4_33UDI-idt-UMI"]="c_ll_ba_0227" ["HY5WLDSXX_4_45UDI-idt-UMI"]="c_ll_ba_0228" ["HY5WLDSXX_4_57UDI-idt-UMI"]="c_ll_ba_0230" ["HY5WLDSXX_4_69UDI-idt-UMI"]="c_ll_ba_0233" ["HY5WLDSXX_4_81UDI-idt-UMI"]="c_ll_ca_0241" ["HY5WLDSXX_4_93UDI-idt-UMI"]="c_ll_ca_0242" ["HY5WLDSXX_4_10UDI-idt-UMI"]="c_ll_ca_0243" ["HY5WLDSXX_4_202UDI-idt-UMI"]="c_ll_ca_0244" ["HY5WLDSXX_4_214UDI-idt-UMI"]="c_ll_ca_0245" ["HY5WLDSXX_4_226UDI-idt-UMI"]="c_ll_ca_0247" ["HY5WLDSXX_4_238UDI-idt-UMI"]="c_ll_ca_0248" ["HY5WLDSXX_4_262UDI-idt-UMI"]="c_ll_ca_0252" ["HY5WLDSXX_4_274UDI-idt-UMI"]="c_ll_ca_0253" ["HY5WLDSXX_4_286UDI-idt-UMI"]="c_ll_ca_0254" ["HY5WLDSXX_4_203UDI-idt-UMI"]="c_ll_ca_0259" ["HY5WLDSXX_4_215UDI-idt-UMI"]="c_ll_ca_0260")

for sample in $(echo ${BARCODEID[@]} | tr ' ' '\n' | sort -u)
  do   
   echo $sample
   sbatch mapstats_tablemaker_LyCaRef_LYNX21.sh ${sample} /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/LYNX_21_Trimmomatic/LYNX_21_trimmomatic/PairEnd
done

c_ll_ba_0226
Submitted batch job 3787484
c_ll_ba_0227
Submitted batch job 3787485
c_ll_ba_0228
Submitted batch job 3787486
c_ll_ba_0229
Submitted batch job 3787487
c_ll_ba_0230
Submitted batch job 3787488
c_ll_ba_0233
Submitted batch job 3787489
c_ll_ca_0241
Submitted batch job 3787490
c_ll_ca_0242
Submitted batch job 3787491
c_ll_ca_0243
Submitted batch job 3787492
c_ll_ca_0244
Submitted batch job 3787493
c_ll_ca_0245
Submitted batch job 3787494
c_ll_ca_0247
Submitted batch job 3787495
c_ll_ca_0248
Submitted batch job 3787496
c_ll_ca_0249
Submitted batch job 3787497
c_ll_ca_0252
Submitted batch job 3787498
c_ll_ca_0253
Submitted batch job 3787499
c_ll_ca_0254
Submitted batch job 3787500
c_ll_ca_0259
Submitted batch job 3787501
c_ll_ca_0260
Submitted batch job 3787502
```
For MACROGEN samples I also wrote a slightly modified script (0.Mapping-executables/mapstats_tablemaker_LyCaRef_MACROGEN.sh) and sbatched it like this:
```
declare -A BARCODEID
# BARCODE MACROGEN:
BARCODEID+=(["LC1"]="c_lc_zz_0001" ["LL112"]="c_ll_vl_0112" ["LL146"]="c_ll_ya_0146" ["LL212"]="c_ll_cr_0212" ["LL90"]="c_ll_ki_0090" ["LR1"]="c_lr_zz_0001")

for sample in $(echo ${BARCODEID[@]} | tr ' ' '\n' | grep "_ll_" | sort -u)
  do   
   echo $sample
   sbatch mapstats_tablemaker_LyCaRef_LYNX21.sh ${sample} /mnt/netapp1/Store_csebdjgl/lynx_genome/lynx_data/MAGROGEN
done

c_ll_cr_0212
Submitted batch job 3788111
c_ll_ki_0090
Submitted batch job 3788112
c_ll_vl_0112
Submitted batch job 3788113
c_ll_ya_0146
Submitted batch job 3788114
```
